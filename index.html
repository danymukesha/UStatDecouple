<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Probabilistic Decoupling for U-Statistics in Genomic Analysis • UStatDecouple</title>
<script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Probabilistic Decoupling for U-Statistics in Genomic Analysis">
<meta name="description" content="Decoupling techniques for U-statistics to transform dependent sample statistics into averages of independent sequences, specifically optimized for genomic data analysis. Provides tools for variance estimation, hypothesis testing, and confidence interval construction for complex genomic metrics.">
<meta property="og:description" content="Decoupling techniques for U-statistics to transform dependent sample statistics into averages of independent sequences, specifically optimized for genomic data analysis. Provides tools for variance estimation, hypothesis testing, and confidence interval construction for complex genomic metrics.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">UStatDecouple</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/UStatDecouple.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danymukesha/UStatDecouple/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="ustatdecouple-probabilistic-decoupling-for-u-statistics">UStatDecouple: Probabilistic Decoupling for U-Statistics<a class="anchor" aria-label="anchor" href="#ustatdecouple-probabilistic-decoupling-for-u-statistics"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>UStatDecouple</code> implements probabilistic decoupling techniques for U-statistics, transforming dependent sample statistics into averages of independent sequences. This package provides rigorous statistical tools for genomic data analysis, enabling accurate variance estimation, hypothesis testing, and confidence interval construction for complex genomic metrics.</p>
<p>The package is based on the theoretical framework developed by de la Peña and colleagues for decoupling inequalities in probability theory , specifically optimized for biological sequence analysis and genomic applications.</p>
<p>The framework is realized through an S4 object-oriented design and a high-performance C++ (Rcpp) back-end implementation, addressing the quadratic (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math>) complexity of U-statistics. Parallel processing is supported via BiocParallel, and pre-defined biological kernels facilitate DNA sequence and gene expression analyses. Vignettes and case studies illustrating are provide with the package for practical applications of the methods.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can also install the package directly from GitHub using the <code>devtools</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"danymukesha/UStatDecouple"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>Performing decoupled U-statistic analysis on DNA sequence data. It allows to compute kernel-based distances, estimate distributions, and visualize results efficiently.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://danymukesha.github.io/UStatDecouple/">UStatDecouple</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_example_sequences.html">load_example_sequences</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kernel</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_kernel.html">create_kernel</a></span><span class="op">(</span><span class="va">hamming_distance_kernel</span>, <span class="st">"Hamming Distance"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/decouple_u_stat.html">decouple_u_stat</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">kernel</span>, B <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; DecoupleResult object:</span></span>
<span><span class="co">#&gt;   Original U-statistic: 2.0000</span></span>
<span><span class="co">#&gt;   Decoupled mean: 1.4696</span></span>
<span><span class="co">#&gt;   Decoupled SD: 0.2567</span></span>
<span><span class="co">#&gt;   Kernel: Hamming Distance</span></span>
<span><span class="co">#&gt;   Method: Friedman-de la Pena Decoupling</span></span>
<span><span class="co">#&gt;   P-value: 0.0388</span></span>
<span><span class="co">#&gt;   Z-score: 2.0663</span></span>
<span><span class="co">#&gt;   Significance: * (p = 0.0388)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-framework-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="biological-applications">Biological Applications<a class="anchor" aria-label="anchor" href="#biological-applications"></a>
</h2>
<div class="section level3">
<h3 id="dna-sequence-diversity-analysis">DNA Sequence Diversity Analysis<a class="anchor" aria-label="anchor" href="#dna-sequence-diversity-analysis"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_genomic_case_study.html">run_genomic_case_study</a></span><span class="op">(</span></span>
<span>  num_sequences <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  sequence_length <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Biological Interpretation ===</span></span>
<span><span class="co">#&gt; Original mean Hamming distance: 74.0667</span></span>
<span><span class="co">#&gt; Expected distance under independence: 69.1327</span></span>
<span><span class="co">#&gt; Observed distance is 3.80 standard deviations from independence expectation</span></span>
<span><span class="co">#&gt; Significant evidence of dependence between sequences (p &lt; 0.05)</span></span>
<span><span class="co">#&gt; This suggests shared evolutionary history or functional constraints</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gene-expression-correlation-analysis">Gene Expression Correlation Analysis<a class="anchor" aria-label="anchor" href="#gene-expression-correlation-analysis"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expr_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/analyze_gene_expression_correlations.html">analyze_gene_expression_correlations</a></span><span class="op">(</span></span>
<span>  num_genes <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  num_samples <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'MASS' was built under R version 4.4.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Gene Expression Analysis ===</span></span>
<span><span class="co">#&gt; Original mean absolute correlation: 0.2255</span></span>
<span><span class="co">#&gt; Expected correlation under independence: 0.2512</span></span>
<span><span class="co">#&gt; Variance inflation factor: Inf</span></span>
<span><span class="co">#&gt; No significant evidence of co-expression structure (p &gt;= 0.05)</span></span>
<span><span class="co">#&gt; Genes appear to be expressed independently</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="theoretical-background">Theoretical Background<a class="anchor" aria-label="anchor" href="#theoretical-background"></a>
</h2>
<p>The package implements the Friedman-de la Peña decoupling method, which transforms dependent U-statistics:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>n</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mi>n</mi><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mfrac><munder><mo>∑</mo><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo>≤</mo><mi>n</mi></mrow></munder><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">U_n = \frac{1}{\binom{n}{2}} \sum_{1 \leq i &lt; j \leq n} h(X_i, X_j)</annotation></semantics></math></p>
<p>into independent versions:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>n</mi></msub><mi>′</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mi>n</mi><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mfrac><munder><mo>∑</mo><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo>≤</mo><mi>n</mi></mrow></munder><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">U_n' = \frac{1}{\binom{n}{2}} \sum_{1 \leq i &lt; j \leq n} h(X_i, Y_j)</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>j</mi></msub><annotation encoding="application/x-tex">Y_j</annotation></semantics></math> are independent copies of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>j</mi></msub><annotation encoding="application/x-tex">X_j</annotation></semantics></math>. This transformation enables the use of classical statistical methods designed for independent data .</p>
</div>
<div class="section level2">
<h2 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h2>
<p>The C++ implementation provides significant speed improvements:</p>
<table class="table">
<thead><tr class="header">
<th>Dataset Size</th>
<th>Pure R (seconds)</th>
<th>C++ (seconds)</th>
<th>Speedup</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>n=10, B=100</td>
<td>2.1</td>
<td>0.05</td>
<td>42x</td>
</tr>
<tr class="even">
<td>n=50, B=500</td>
<td>156.3</td>
<td>1.8</td>
<td>87x</td>
</tr>
<tr class="odd">
<td>n=100, B=1000</td>
<td>1242.7</td>
<td>12.5</td>
<td>99x</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<ul>
<li><a href="https://github.com/danymukesha/UStatDecouple" class="external-link">Source Code</a></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/danymukesha/UStatDecouple/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/danymukesha/UStatDecouple/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>What license is it under?</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing UStatDecouple</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://danymukesha.github.io/" class="external-link">Dany Mukesha</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0001-9514-751X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://danymukesha.github.io/" class="external-link">Dany Mukesha</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
