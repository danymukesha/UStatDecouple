# UStatDecouple: Probabilistic Decoupling for U-Statistics

## Overview

`UStatDecouple` implements probabilistic decoupling techniques for
U-statistics, transforming dependent sample statistics into averages of
independent sequences. This package provides rigorous statistical tools
for genomic data analysis, enabling accurate variance estimation,
hypothesis testing, and confidence interval construction for complex
genomic metrics.

The package is based on the theoretical framework developed by de la
Peña and colleagues for decoupling inequalities in probability theory ,
specifically optimized for biological sequence analysis and genomic
applications.

The framework is realized through an S4 object-oriented design and a
high-performance C++ (Rcpp) back-end implementation, addressing the
quadratic ($O\left( n^{2} \right)$) complexity of U-statistics. Parallel
processing is supported via BiocParallel, and pre-defined biological
kernels facilitate DNA sequence and gene expression analyses. Vignettes
and case studies illustrating are provide with the package for practical
applications of the methods.

## Installation

You can also install the package directly from GitHub using the
`devtools` package:

``` r
devtools::install_github("danymukesha/UStatDecouple")
```

## Quick Start

Rerforming decoupled U-statistic analysis on DNA sequence data. It
allows to compute kernel-based distances, estimate distributions, and
visualize results efficiently.

``` r
library(UStatDecouple)

data <- load_example_sequences()

kernel <- create_kernel(hamming_distance_kernel, "Hamming Distance")

result <- decouple_u_stat(data, kernel, B = 500)

print(result)
#> DecoupleResult object:
#>   Original U-statistic: 2.0000
#>   Decoupled mean: 1.4696
#>   Decoupled SD: 0.2567
#>   Kernel: Hamming Distance
#>   Method: Friedman-de la Pena Decoupling
#>   P-value: 0.0388
#>   Z-score: 2.0663
#>   Significance: * (p = 0.0388)

plot(result)
```

![](reference/figures/README-framework-1.png)

## Biological Applications

### DNA Sequence Diversity Analysis

``` r
result <- run_genomic_case_study(
  num_sequences = 15,
  sequence_length = 100,
  B = 200
)
#> 
#> === Biological Interpretation ===
#> Original mean Hamming distance: 74.0667
#> Expected distance under independence: 69.1327
#> Observed distance is 3.80 standard deviations from independence expectation
#> Significant evidence of dependence between sequences (p < 0.05)
#> This suggests shared evolutionary history or functional constraints
```

### Gene Expression Correlation Analysis

``` r
expr_result <- analyze_gene_expression_correlations(
  num_genes = 30,
  num_samples = 20,
  B = 500
)
#> Warning: package 'MASS' was built under R version 4.4.2
#> 
#> === Gene Expression Analysis ===
#> Original mean absolute correlation: 0.2255
#> Expected correlation under independence: 0.2512
#> Variance inflation factor: Inf
#> No significant evidence of co-expression structure (p >= 0.05)
#> Genes appear to be expressed independently
```

## Theoretical Background

The package implements the Friedman-de la Peña decoupling method, which
transforms dependent U-statistics:

$$U_{n} = \frac{1}{\left( \frac{n}{2} \right)}\sum\limits_{1 \leq i < j \leq n}h\left( X_{i},X_{j} \right)$$

into independent versions:

$$U_{n}\prime = \frac{1}{\left( \frac{n}{2} \right)}\sum\limits_{1 \leq i < j \leq n}h\left( X_{i},Y_{j} \right)$$

where $Y_{j}$ are independent copies of $X_{j}$. This transformation
enables the use of classical statistical methods designed for
independent data .

## Performance

The C++ implementation provides significant speed improvements:

| Dataset Size  | Pure R (seconds) | C++ (seconds) | Speedup |
|---------------|------------------|---------------|---------|
| n=10, B=100   | 2.1              | 0.05          | 42x     |
| n=50, B=500   | 156.3            | 1.8           | 87x     |
| n=100, B=1000 | 1242.7           | 12.5          | 99x     |

## Documentation

- [Source Code](https://github.com/danymukesha/UStatDecouple)

# Package index

## All functions

- [`DecoupleResult-class`](https://danymukesha.github.io/UStatDecouple/reference/DecoupleResult-class.md)
  : DecoupleResult Class
- [`UStatKernel-class`](https://danymukesha.github.io/UStatDecouple/reference/UStatKernel-class.md)
  : UStatKernel Class
- [`analyze_gene_expression_correlations()`](https://danymukesha.github.io/UStatDecouple/reference/analyze_gene_expression_correlations.md)
  : Analyze Gene Expression Correlation Structure
- [`create_kernel()`](https://danymukesha.github.io/UStatDecouple/reference/create_kernel.md)
  : Create U-statistic kernel
- [`decouple_u_stat()`](https://danymukesha.github.io/UStatDecouple/reference/decouple_u_stat.md)
  : Decouple a U-statistic
- [`gene_expression_correlation_kernel()`](https://danymukesha.github.io/UStatDecouple/reference/gene_expression_correlation_kernel.md)
  : Gene Expression Correlation Kernel
- [`hamming_distance_kernel()`](https://danymukesha.github.io/UStatDecouple/reference/hamming_distance_kernel.md)
  : Hamming Distance Kernel
- [`hello()`](https://danymukesha.github.io/UStatDecouple/reference/hello.md)
  : Hello, World!
- [`load_example_sequences()`](https://danymukesha.github.io/UStatDecouple/reference/load_example_sequences.md)
  : Load Example DNA Sequences
- [`plot(`*`<DecoupleResult>`*`,`*`<ANY>`*`)`](https://danymukesha.github.io/UStatDecouple/reference/plot-DecoupleResult-ANY-method.md)
  : Plot DecoupleResult
- [`run_genomic_case_study()`](https://danymukesha.github.io/UStatDecouple/reference/run_genomic_case_study.md)
  : Run Genomic Case Study: DNA Sequence Diversity
- [`show(`*`<DecoupleResult>`*`)`](https://danymukesha.github.io/UStatDecouple/reference/show-DecoupleResult-method.md)
  : Show method for DecoupleResult
- [`validate_input_data()`](https://danymukesha.github.io/UStatDecouple/reference/validate_input_data.md)
  : Validate Input Data

# Articles

### All vignettes

- [UStatDecouple: Probabilistic Decoupling for U-Statistics in Genomic
  Analysis](https://danymukesha.github.io/UStatDecouple/articles/UStatDecouple.md):
